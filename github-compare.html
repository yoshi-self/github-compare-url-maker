<!DOCTYPE html>
<html>
  <head>
    <title>GitHub Compare URL Maker</title>
    <style>
input {
  font-size: 14px;
  margin-bottom: 5px;
}
    </style>
  </head>
  <body>
    <h1>GitHub Compare URL Maker</h1>
    <p>
    <strong>Usage: </strong>
    <div>
      Put 2 commit URLs and click the button<br>
      You can also put branch names or tag names<br>
    </div>
    </p>
    <table>
      <tr>
        <td>From</td>
        <td><input type="text" id="from-text" size="90"></td>
      </tr>
      <tr>
        <td>To</td>
        <td><input type="text" id="to-text" size="90"></td>
      </tr>
    </table>
    Repo: <input type="text" id="user-name-text" size="15"> / <input type="text" id="repo-name-text" size="15"><span style="color:#888"> (Fill these only when neither of above include URL)</span><br>
    <input type="button" onclick="updateCompareUrl();" value="Make URL"><br>
    Compare URL : <a id="compare-link" href="javascipt:void(0);" target="_blank"></a><br>
    <br>
    <br>
    GitHub repo: <a href="https://github.com/yoshi-self/github-compare-url-maker" target="_blank">yoshi-self/github-compare-url-maker</a>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script>
function updateCompareUrl() {
  // TODO: support name like 'feature/some_branch'
  var from = $('#from-text').val();
  var fromArr = from.split('/');
  var to = $('#to-text').val();
  var toArr = to.split('/');
  var baseUrl = "";
  if(from.startsWith("http")) {
    var scheme = fromArr[0];
    var userName = fromArr[3];
    var repoName = fromArr[4];
    baseUrl = scheme + '//github.com/' + userName + '/' + repoName + '/compare/'
  }
  else if(to.startsWith("http")) {
    var scheme = toArr[0];
    var userName = toArr[3];
    var repoName = toArr[4];
    baseUrl += scheme + '//github.com/' + userName + '/' + repoName + '/compare/'
  }
  else {
    // TODO
    var scheme = "https:"
    var userName = $("#user-name-text").val();
    var repoName = $("#repo-name-text").val();
    baseUrl += scheme + '//github.com/' + userName + '/' + repoName + '/compare/'
  }
  // TODO: check baseUrl correct
  var url = baseUrl + fromArr[fromArr.length - 1] + '...' + toArr[toArr.length - 1];
  /*
  var url = scheme + '//github.com/' + userName + '/' + repoName + '/compare/'
      + fromArr[fromArr.length - 1] + '...' + toArr[toArr.length - 1];
      */
  $('#compare-link').attr('href', url);
  $('#compare-link').text(url);
}

$(function(){
});
    </script>
  </body>
</html>
